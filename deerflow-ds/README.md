# DeerFlow DS - 数据科学引擎参考示例

这个项目是deer-flow的核心流程和架构的参考示例，专门为deepresearch引擎设计提供参考。其他项目可以基于这些代码和文档进行重构。

## 项目概述

DeerFlow是一个基于LangGraph框架的智能代理系统，具有强大的泛化能力。本示例项目展示了：

- 核心工作流程设计
- 多智能体协作架构
- 状态管理和图构建
- 工具集成和扩展机制
- 配置管理和提示工程

## 核心架构

### 1. 主要组件

```
├── main.py                 # 程序入口点
├── src/
│   ├── workflow.py         # 工作流程管理
│   ├── graph/             # LangGraph图构建和节点定义
│   ├── config/            # 配置管理
│   ├── prompts/           # 提示模板
│   ├── agents/            # 智能体定义
│   ├── llms/              # LLM提供商
│   ├── tools/             # 工具集
│   ├── rag/               # 检索增强生成
│   └── utils/             # 工具函数
└── docs/                  # 详细文档
```

### 2. 核心流程

1. **协调器 (Coordinator)**: 接收用户输入，分配任务
2. **背景调查 (Background Investigation)**: 收集背景信息
3. **规划器 (Planner)**: 制定执行计划
4. **执行团队**:
   - 研究员 (Researcher): 信息收集和分析
   - 编码器 (Coder): 代码执行和数据处理
   - 研究团队 (Research Team): 协作研究
5. **报告器 (Reporter)**: 生成最终报告
6. **人工反馈 (Human Feedback)**: 人工干预和验证

### 3. 状态管理

系统使用`State`类管理整个工作流程的状态，包括：

- 消息历史
- 研究主题
- 观察结果
- 资源列表
- 当前计划
- 最终报告
- 配置参数

## 使用说明

### 基本使用

```python
# 导入工作流程
from src.workflow import run_agent_workflow_async

# 运行工作流程
await run_agent_workflow_async(
    user_input="你的研究问题",
    debug=False,
    max_plan_iterations=1,
    max_step_num=3,
    enable_background_investigation=True
)
```

### 自定义配置

可以通过修改`src/config/`目录下的配置文件来自定义系统行为：

- `agents.py`: 智能体配置
- `configuration.py`: 系统配置
- `questions.py`: 预设问题

### 扩展工具

在`src/tools/`目录下添加新的工具：

1. 创建工具函数
2. 在`__init__.py`中注册
3. 在相应智能体中启用

## 关键特性

### 1. 模块化设计

- 每个组件都可以独立扩展
- 清晰的接口定义
- 松耦合架构

### 2. 多智能体协作

- 专门化的智能体角色
- 协调器统一管理
- 动态任务分配

### 3. 状态持久化

- 内存检查点支持
- 可扩展到数据库
- 会话管理

### 4. 工具集成

- 搜索工具
- 代码执行
- 文件操作
- 外部API调用

### 5. 错误处理

- 完善的异常处理
- 日志记录
- 重试机制

## 最佳实践

### 1. 项目结构

保持清晰的目录结构，便于维护和扩展。

### 2. 配置管理

使用配置文件而不是硬编码，提高灵活性。

### 3. 错误处理

为每个组件添加适当的错误处理和日志记录。

### 4. 测试

为每个模块编写单元测试和集成测试。

### 5. 文档

保持代码和文档的同步更新。

## 依赖项

查看`pyproject.toml`文件了解完整的依赖项列表。

主要依赖：

- `langgraph`: 图构建和执行
- `langchain`: LLM集成
- `langchain-core`: 核心组件
- 各种工具和提供程序

## 扩展指南

### 1. 添加新的智能体

1. 在`src/agents/`中定义新的智能体
2. 在`src/config/agents.py`中配置
3. 在图构建中添加节点

### 2. 添加新的工具

1. 在`src/tools/`中实现工具
2. 注册到智能体
3. 更新配置

### 3. 修改工作流程

1. 编辑`src/graph/builder.py`
2. 添加或修改节点
3. 更新状态管理

## 注意事项

1. 这个示例项目仅供参考，实际使用时需要根据具体需求进行调整
2. 某些配置可能需要根据你的环境进行修改
3. 确保所有依赖项都已正确安装
4. 遵守相关开源许可证

## 贡献

如果你有改进建议或发现了问题，请提交issue或pull request。

## 许可证

遵循原项目的MIT许可证。
